from aiogram.types import InlineKeyboardMarkup, InlineKeyboardButton

from utils.db_api.db_commands import select_categories, select_items, select_product_subcategories, \
    select_smm_subcategories, select_product_items, select_product_subcategory, select_all_mails, select_mail

# ========================ADMIN MENU========================
admin_menu = InlineKeyboardMarkup(
    inline_keyboard=[
        [
            InlineKeyboardButton(text="üìÆ–†–∞—Å—Å—ã–ª–∫–∞", callback_data="broadcast"),
            InlineKeyboardMarkup(text="‚öôÔ∏è–ù–∞—Å—Ç—Ä–æ–π–∫–∏", callback_data="edit_settings")
        ],
        [
            InlineKeyboardButton(text="üì•–í—ã–¥–∞—Ç—å –±–∞–ª–∞–Ω—Å", callback_data="balance:add"),
            InlineKeyboardButton(text="üì§–ó–∞–±—Ä–∞—Ç—å –±–∞–ª–∞–Ω—Å", callback_data="balance:remove")
        ],
        [
            InlineKeyboardButton(text="üìå–î–æ–±–∞–≤–∏—Ç—å", callback_data="add"),
        ],
        [

            InlineKeyboardButton(text="üìä–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞", callback_data="admin_stat"),
            InlineKeyboardButton(text="üîé –ù–∞–π—Ç–∏ —é–∑–µ—Ä–∞", callback_data="get_user")
        ],
        [
            InlineKeyboardButton(text="‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å", callback_data="edit_buttons"),
            InlineKeyboardButton(text="üì®–ü–æ–¥–¥–µ—Ä–∂–∫–∞", callback_data="help")
        ],
        [
            InlineKeyboardButton(text="üîô–í –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é", callback_data="back_to_main_menu")
        ]
    ]
)

# ======================== BROADCAST MARKUP ========================
broadcast_menu = InlineKeyboardMarkup(
    inline_keyboard=[
        [
            InlineKeyboardButton(text="‚ùå–°–∫—Ä—ã—Ç—å", callback_data="delete_this_message")
        ]
    ]
)

edit_buttons_menu = InlineKeyboardMarkup(
    inline_keyboard=[
        [
            InlineKeyboardButton(text="üì¶–¢–æ–≤–∞—Ä—ã", callback_data="edit:product"),
            InlineKeyboardButton(text="üìä –ù–∞–∫—Ä—É—Ç–∫–∞ ", callback_data="edit:smm")
        ],
        [
            InlineKeyboardButton(text="‚¨ÖÔ∏è–ù–∞–∑–∞–¥", callback_data="back_admin")
        ]
    ]
)

# START BROADCAST
choose_menu = InlineKeyboardMarkup(
    inline_keyboard=[
        [
            InlineKeyboardButton(text="‚úÖ–î–∞", callback_data="yes")
        ],
        [
            InlineKeyboardButton(text="‚ùå–û—Ç–º–µ–Ω–∞", callback_data="no")
        ]
    ]
)

# ======================== BACK TO ADMIN MENU BUTTON ========================
back_admin = InlineKeyboardMarkup(
    inline_keyboard=[
        [
            InlineKeyboardButton(text="‚¨ÖÔ∏è–ù–∞–∑–∞–¥", callback_data="back_admin")
        ]
    ]
)

# ======================== TYPE OF BUTTONS TO DELETE MENU ========================
delete_button_type_menu = InlineKeyboardMarkup(
    inline_keyboard=[
        [
            InlineKeyboardButton(text="üìå–ö–∞—Ç–µ–≥–æ—Ä–∏—è", callback_data="del_button:category")
        ],
        [
            InlineKeyboardButton(text="üìå–ü–æ–¥-–∫–∞—Ç–µ–≥–æ—Ä–∏—è", callback_data="del_button:subcategory"),
        ],
        [
            InlineKeyboardButton(text="üìå–£—Å–ª—É–≥–∞", callback_data="del_button:item")
        ],
        [
            InlineKeyboardButton(text="‚¨ÖÔ∏è–ù–∞–∑–∞–¥", callback_data="back_admin")
        ]
    ]
)

button_type_menu = InlineKeyboardMarkup(
    inline_keyboard=[
        [
            InlineKeyboardButton(text="üìä –ù–∞–∫—Ä—É—Ç–∫–∞ ", callback_data="add_button:smm")
        ],
        [
            InlineKeyboardButton(text="üì¶ –¢–æ–≤–∞—Ä—ã", callback_data="add_button:product"),
        ],
        [
            InlineKeyboardButton(text="‚¨ÖÔ∏è–ù–∞–∑–∞–¥", callback_data="back_admin")
        ]
    ]
)

product_type_menu = InlineKeyboardMarkup(
    inline_keyboard=[
        [
            InlineKeyboardButton(text="–¢–µ–∫—Å—Ç", callback_data="product_type:text")
        ],
        [
            InlineKeyboardButton(text="–§–∞–π–ª", callback_data="product_type:file"),
        ],
        [
            InlineKeyboardButton(text="‚¨ÖÔ∏è–ù–∞–∑–∞–¥", callback_data="back_admin")
        ]
    ]
)


# ======================== TYPE OF BUTTONS TO ADD MENU ========================
async def add_button_type_menu(button_type):
    keyboard = InlineKeyboardMarkup(
        inline_keyboard=[
            [
                InlineKeyboardButton(text="üìå–ö–∞—Ç–µ–≥–æ—Ä–∏—è", callback_data=f"button_type:category:{button_type}")
            ],
            [
                InlineKeyboardButton(text="üìå–ü–æ–¥-–∫–∞—Ç–µ–≥–æ—Ä–∏—è", callback_data=f"button_type:subcategory:{button_type}"),
            ],
            [
                InlineKeyboardButton(text="üìå–£—Å–ª—É–≥–∞/—Ç–æ–≤–∞—Ä", callback_data=f"button_type:item:{button_type}")
            ],
            [
                InlineKeyboardButton(text="‚¨ÖÔ∏è–ù–∞–∑–∞–¥", callback_data="back_admin")
            ]
        ]
    )
    return keyboard


# ======================== GET USER MARKUP ========================
get_user_menu = InlineKeyboardMarkup(
    inline_keyboard=[
        [
            InlineKeyboardButton(text="üéä–ò–∑–º–µ–Ω–∏—Ç—å –±–æ–Ω—É—Å", callback_data="edit_bonus")
        ],
        [
            InlineKeyboardButton(text="üë§–°–ø–∏—Å–æ–∫ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤", callback_data="ref_list")
        ],
        [
            InlineKeyboardButton(text="‚¨ÖÔ∏è–ù–∞–∑–∞–¥", callback_data="back_admin")
        ]
    ]
)

# ======================== GENERAL SETTINGS MARKUP ========================
admin_settings_menu = InlineKeyboardMarkup(
    inline_keyboard=[
        [
            InlineKeyboardButton(text="üîê –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–æ—à–µ–ª—ë–∫", callback_data="choose_settings:wallet")
        ],
        [
            InlineKeyboardButton(text="üéÅ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–∞–Ω–∞–ª", callback_data="choose_settings:gift")
        ],
        [
            InlineKeyboardButton(text="üíæ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ", callback_data="edit_log_channel")

        ],
        [
            InlineKeyboardButton(text="‚¨ÖÔ∏è–ù–∞–∑–∞–¥", callback_data="back_admin")
        ]
    ]
)

# ======================== WALLET SETTINGS MARKUP ========================
wallet_settings_menu = InlineKeyboardMarkup(
    inline_keyboard=[
        [
            InlineKeyboardButton(text="üîë –í–≤–µ—Å—Ç–∏ —Ç–æ–∫–µ–Ω", callback_data="settings:token")
        ],
        [
            InlineKeyboardButton(text="üì± –í–≤–µ—Å—Ç–∏ –Ω–æ–º–µ—Ä", callback_data="settings:num")
        ],
        [
            InlineKeyboardButton(text="üóù –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á", callback_data="settings:p2p")

        ],
        [
            InlineKeyboardButton(text="üîê –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á", callback_data="edit_qiwi_secret")
        ],
        [
            InlineKeyboardButton(text="‚¨ÖÔ∏è–ù–∞–∑–∞–¥", callback_data="edit_settings")
        ]
    ]
)

# ======================== GIFT SETTINGS MARKUP ========================
gift_settings_menu = InlineKeyboardMarkup(
    inline_keyboard=[
        [
            InlineKeyboardButton(text="üîó –ò–∑–º–µ–Ω–∏—Ç—å –°—Å—ã–ª–∫—É  ", callback_data="edit_channel_url")
        ],
        [
            InlineKeyboardButton(text="üÜî –ò–∑–º–µ–Ω–∏—Ç—å ID", callback_data="edit_channel_id")
        ],
        [
            InlineKeyboardButton(text="‚¨ÖÔ∏è–ù–∞–∑–∞–¥", callback_data="edit_settings")
        ]
    ]
)


# ======================== ALL CATEGORIES TO ADD/DELETE ========================
async def admin_all_categories(item_type):
    categories = await select_categories(category_type=item_type)
    keyboard = InlineKeyboardMarkup(row_width=2)
    for category in categories:
        keyboard.insert(InlineKeyboardButton(text=category[0], callback_data=f"adm_cat:{category[1]}"))
    keyboard.add(InlineKeyboardButton(text="üîô–ù–∞–∑–∞–¥", callback_data="back_admin"))
    return keyboard


# ======================== SUBCATEGORIES TO ADD/DELETE ========================
async def admin_all_subcategories(category, item_type):
    subcategories = await select_smm_subcategories(category) if item_type == "smm" \
        else await select_product_subcategories(category)
    keyboard = InlineKeyboardMarkup(row_width=1)
    for subcategory in subcategories:
        keyboard.insert(InlineKeyboardButton(text=subcategory[2], callback_data=f"adm_sub:{subcategory[1]}"))
    keyboard.insert(InlineKeyboardButton(text="üîô–ù–∞–∑–∞–¥", callback_data="back_admin"))
    return keyboard


async def admin_edit_subcategories(category, item_type):
    subcategories = await select_smm_subcategories(category) if item_type == "smm" \
        else await select_product_subcategories(category)
    keyboard = InlineKeyboardMarkup(row_width=2)
    for subcategory in subcategories:
        keyboard.add(InlineKeyboardButton(text=subcategory[2], callback_data=f"adm_sub:{subcategory[1]}"))
    keyboard.add(InlineKeyboardButton(text="üìù–ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ",
                                      callback_data=f"edit_button_arg:category:{category}:name"))
    keyboard.insert(InlineKeyboardButton(text="üóë–£–¥–∞–ª–∏—Ç—å", callback_data=f"delete_button:category:{category}"))
    keyboard.add(InlineKeyboardButton(text="üîô–ù–∞–∑–∞–¥", callback_data="back_admin"))
    return keyboard


# ======================== ITEMS TO EDIT/DELETE ========================
async def admin_items_menu(subcategory, item_type):
    items = await select_items(subcategory) if item_type == "smm" else await select_product_items(subcategory)
    keyboard = InlineKeyboardMarkup(row_width=2)
    for item in items:
        if item_type == "smm":
            keyboard.add(InlineKeyboardButton(text=item[0], callback_data=f"adm_item:{item[8]}"))
        else:
            keyboard.add(InlineKeyboardButton(text=item[2], callback_data=f"adm_item:{item[3]}"))
    keyboard.add(InlineKeyboardButton(text="üìù–ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ",
                                      callback_data=f"edit_button_arg:sub:{subcategory}:name"))
    keyboard.insert(InlineKeyboardButton(text="üóë–£–¥–∞–ª–∏—Ç—å", callback_data=f"delete_button:sub:{subcategory}"))
    if item_type == "product":
        product_sub = await select_product_subcategory(subcategory)
        keyboard.add(InlineKeyboardButton(text="üìù–ò–∑–º–µ–Ω–∏—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ",
                                          callback_data=f"edit_button_arg:sub:{subcategory}:desc"))
        keyboard.insert(InlineKeyboardButton(text="üìù–ò–∑–º–µ–Ω–∏—Ç—å —Ü–µ–Ω—É",
                                             callback_data=f"edit_button_arg:sub:{subcategory}:cost"))
        keyboard.add(InlineKeyboardButton(text=f"{'üóÇ' if product_sub[5] == 'file' else 'üìß'}–¢–∏–ø –ø—Ä–æ–¥–∞–∂–∏: "
                                               f"{'–§–∞–π–ª' if product_sub[5] == 'file' else '–¢–µ–∫—Å—Ç'}",
                                          callback_data=f"edit_sell_type:{subcategory}"))
    keyboard.add(InlineKeyboardButton(text="üîô–ù–∞–∑–∞–¥", callback_data="back_admin"))
    return keyboard


# ======================== EDIT ITEM MARKUP ========================

async def edit_item_menu(item_id, item_type):
    keyboard = InlineKeyboardMarkup(
        inline_keyboard=[
            [
                InlineKeyboardButton(text="üìù–ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ",
                                     callback_data=f"edit_button_arg:item:{item_id}:name")
            ] if item_type == "smm" else [],
            [
                InlineKeyboardButton(text="üÜî –ò–∑–º–µ–Ω–∏—Ç—å ID ", callback_data=f"edit_button_arg:item:{item_id}:id"),
                InlineKeyboardButton(text="üìù–ò–∑–º–µ–Ω–∏—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ", callback_data=f"edit_button_arg:item:{item_id}:desc")
            ] if item_type == "smm" else [],
            [
                InlineKeyboardButton(text="üí∞–ò–∑–º–µ–Ω–∏—Ç—å —Ü–µ–Ω—É", callback_data=f"edit_button_arg:item:{item_id}:cost"),
                InlineKeyboardButton(text="üåÄ–ò–∑–º–µ–Ω–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ",
                                     callback_data=f"edit_button_arg:item:{item_id}:count")
            ] if item_type == "smm" else [],
            [
                InlineKeyboardButton(text="üóë–£–¥–∞–ª–∏—Ç—å", callback_data=f"delete_button:item:{item_id}")
            ],
            [
                InlineKeyboardButton(text="‚¨ÖÔ∏è–ù–∞–∑–∞–¥", callback_data="back_admin")
            ]
        ]
    )
    return keyboard


# MAIL MARKUP
async def mails_menu():
    mails = await select_all_mails()
    keyboard = InlineKeyboardMarkup(row_width=2)
    mail_type = {
        "smm": "üìä –ù–∞–∫—Ä—É—Ç–∫–∞ ",
        "product": "üì¶ –¢–æ–≤–∞—Ä ",
        "payment": "üí≥ –û–ø–ª–∞—Ç–∞ ",
        "other": "‚ùì–î—Ä—É–≥–æ–π –≤–æ–ø—Ä–æ—Å "
    }
    for mail in mails:
        keyboard.insert(InlineKeyboardButton(text=mail_type.get(mail[1]), callback_data=f"adm_help:{mail[0]}"))
    keyboard.add(InlineKeyboardButton(text="üîô–ù–∞–∑–∞–¥", callback_data="back_admin"))
    return keyboard


# MAIL MARKUP
async def in_mail_menu(user_id):
    mail = await select_mail(user_id)
    keyboard = InlineKeyboardMarkup(
        inline_keyboard=[
            [
                InlineKeyboardButton(text="‚û°Ô∏è–û—Ç–≤–µ—Ç–∏—Ç—å", callback_data=f"help_reply:{mail[0]}")
            ],
            [
                InlineKeyboardButton(text="üóë–£–¥–∞–ª–∏—Ç—å", callback_data=f"help_del:{mail[0]}")
            ],
            [
                InlineKeyboardButton(text="‚¨ÖÔ∏è–ù–∞–∑–∞–¥", callback_data="back_admin")
            ]
        ]
    )
    return keyboard
